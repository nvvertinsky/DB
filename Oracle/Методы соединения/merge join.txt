Merge join. Соединение сортировкой-слиянием

Описание: Отличается от соединения методов хеширования тем, что отсутствует концепция ведущей таблицы.
Соединение сортировкой-слиянием будет проводить сортировку первого набора данных, затем сортировку второго набора данных. И после этого будет выполнено слияние результатов.

Соединение сортировкой-слиянием является менее эффективным, чем соединение хешированием из-за того, что ОБА набора данных необходимо подвергнуть сканированию и сортировке. При соединении хешированием предварительной обработке подтвергается только один набор данных.

Является весьма полезным при операциях объединения по неэквивалетности. Т.е. когда условием соединения является сравнение с диапазоном. (<, >, <=, =>).

Хорош для больших объемах входящих данных.

Пример работы:

  select a.ename,
		 b.ename,
		 a.hiredate,
		 b.hiredate
    from emp a,
		 emp b
   where a.empno = b.empno;

  1. Читается "EMP a" и сортируется по empno. 
  2. Читается "EMP b" и сортируется по empno. 
  3. Далее применяется соединение сортировкой-слиянием с использованием условия a.hiredate <= b.hiredate
    1  1
    3  1
    4  2
    6  2
       3
       5	   
	 
    - Сначала сравнивает первые строки двух наборов данных.
	- Затем сравнение идет дальше во втором наборе данных, пока значение равно значению первого набора.
	- Если значение из второго набора данных НЕ РАВНО значению из первого набора данных, то переходим на следующую строку в том наборе данных, где значение ниже. Например "1" из первого набора != "2" из второго набора. Смотрим какое значение ниже. Это "1" из первого набора. Значит переходим на следующую строку в первом наборе.
	- Выводим каждую соединеную запись
  4. Затем применяется фильтр a.empno <> b.empno.
