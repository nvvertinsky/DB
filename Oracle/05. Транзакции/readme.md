## Транзакция
Это перевод БД из одного согласованного состояние в другое.

## Кислотность (ACID)
Требования к транзакционной СУБД
  - Атомарность - транзакция либо выполняется полностью либо не оставляет никаких следов
  - Согласованность - когда соблюдены ограничения целостности (FK, UK, CHK).
  - Изоляция - во время выполнения транзакции, параллельные транзакции не должны оказывать влияние на её результат.
  - Долговечность - изменения в данных являются постоянными.
 
## Аномалии
  - Потерянный обновления
  - Грязное чтение. 
    - Разрешает читать незафиксированные данные.
  - Неповторяющееся чтение
    - Если вы читаете строку в момент времени Т1 
    - Затем в Т2 эта строка обновляется + comiit
    - Затем вы считываете строку повторно в Т3, то вы увидите изменения сделанные в Т2.
  - Фантомное чтение
    - Если вы запустили запрос в момент Т1 
    - Затем кто-то вставил новые строки в таблицу в момент Т2
    - Затем вы снова выполняете запрос, то увидите новые строки.
  
## Уровни изоляции транзакций

### READ UNCOMMITED 
Cессия, может читать данные не зафиксированные в другой сессии

### READ COMMITED
Сессия, видит только зафиксированные данные других сессий.

alter session set transaction read committed;
  

### REPEATABLE READ
Читающая транзакция не видит изменения данных, которые были ею ранее прочитаны
  
В Oracle соблюдается за счет чтения сегмента отката.
  
### SERIALIZABLE
Описание: 
  - Изменения сделанные другими транзакциями мы не увидим.

Как работает в Oracle: 
  - Все так же применяются сегменты отката. Только теперь на момент начала транзакции, а не оператора.

Ошибки: 
  - ORA-08177: Cant serialize access for this transaction. Будем получать при попытке обновления строки, которая изменилась с момента начала транзакции

Когда применять:
  - Требуется согласованность чтения на уровне транзакции 
  - Транзакции будут короткими. Что поможет с первым условием. 
  - Высока вероятность, что никто не модифицирует те же самые данные

Команда: alter session set transaction serializable;

### READ ONLY
Описание: 
  - Не допускают никаких модификаций таблиц

Когда применяется:
  - При формировании отчетов. Если при составлении отчета используется 50 операторов select, то все они будут согласованы на момент начала транзакции, а не на момент начала каждого оператора
  
Как работает: 
  - Собирает данные из сегментов отката на дату начала транзакции
  
Возможные ошибки:
  - ORA-01555: snapshot too old

Команда: alter session set transaction read only;

### Что используется в Oracle: 
  - READ COMMITED (по умолчанию) 
  - SERIALIZABLE