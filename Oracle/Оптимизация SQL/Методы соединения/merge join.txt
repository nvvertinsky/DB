Merge join. Соединение сортировкой-слиянием

Описание: Отличается от соединения методов хеширования тем, что отсутствует концепция ведущей таблицы.
Соединение сортировкой-слиянием будет проводить сортировку первого набора данных, затем сортировку второго набора данных. И после этого будет выполнено слияние результатов.

Соединение сортировкой-слиянием является менее эффективным, чем соединение хешированием из-за того, что ОБА набора данных необходимо подвергнуть сканированию и сортировке. При соединении хешированием предварительной обработке подтвергается только один набор данных.

Является весьма полезным при операциях объединения по неэквивалетности. Т.е. когда условием соединения является сравнение с диапазоном. (<, >, <=, =>).

Хорош для больших объемах входящих данных.

Пример работы:

  select a.ename,
		 b.ename,
		 a.hiredate,
		 b.hiredate
    from emp a,
		 emp b
   where a.hiredate <= b.hiredate
     and a.empno <> b.empno;

  1. Читается "EMP a" и сортируется по HIREDATE. 
  2. Читается "EMP b" и сортируется по HIREDATE. 
  3. Далее применяется соединение сортировкой-слиянием с использованием условия a.hiredate <= b.hiredate
	 01.01.2020  01.01.2020
	 02.01.2020	 05.01.2020
	 03.01.2020	 06.01.2020
	 07.01.2020  07.01.2020
	 
	 - Сначала сравнивает первые строки двух наборов данных.
	 - Затем сравнение идет дальше во втором наборе данных, пока значение равно значению первого входа.
	 - Если значение из второго набора данных НЕ РАВНО значению из первого набора данных, то в первом наборе данных переходим на следующую строку.
	 - Выводим каждую соединеную запись
  4. Затем применяется фильтр a.empno <> b.empno.
